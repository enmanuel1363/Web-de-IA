{% extends 'badmin.html' %}  {# Hereda la plantilla base 'badmin.html' #}

{% block title %}Panel de Administración{% endblock %}  {# Define el título de la página #}

{% block body %}
<!-- ==========================
  ALERTAS DE SWEETALERT2
=========================== -->

{# Mensajes de éxito que provienen de Flask usando flash() #}
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<ul class=flashes>
    {% for category, message in messages %}
    <script type="text/javascript">
        // Creamos un Toast (notificación pequeña) con SweetAlert2
        const Toast = Swal.mixin({
            toast: true,                 // tipo toast
            position: "top-end",         // aparece en esquina superior derecha
            showConfirmButton: false,    // sin botón de confirmación
            timer: 2000,                 // duración 2 segundos
            timerProgressBar: true,      // barra de progreso
            didOpen: (toast) => {        // pausa si se pasa el mouse encima
                toast.onmouseenter = Swal.stopTimer;
                toast.onmouseleave = Swal.resumeTimer;
            }
        });
        Toast.fire({
            icon: "success",             // icono de éxito
            title: "{{message}}"         // mensaje dinámico de Flask
        });
    </script>
    {% endfor %}
</ul>
{% endif %}
{% endwith %}

<!-- ==========================
  ALERTA DE CONFIRMACIÓN ELIMINAR
=========================== -->
<script>
    function confirmarEliminacion(url) {
        Swal.fire({
            title: '¿Estás seguro?',           // Título de la alerta
            text: "¡No podrás revertir esto!", // Mensaje
            icon: 'warning',                    // Icono de advertencia
            showCancelButton: true,             // Muestra botón cancelar
            confirmButtonColor: '#d33',         // Color botón confirmar
            cancelButtonColor: '#3085d6',       // Color botón cancelar
            confirmButtonText: 'Sí, eliminar',  // Texto del botón confirmar
            cancelButtonText: 'Cancelar'        // Texto del botón cancelar
        }).then((result) => {
            if (result.isConfirmed) {           // Si confirma, redirige a la URL
                window.location.href = url;
            }
        });
    }
</script>

<!-- ==========================
  CONTENEDOR PRINCIPAL
=========================== -->
<div class="container p-5 mt-3">
    <h2 class="text-center alert ">
        Sistema de Gestión de cursos IA
    </h2>

    <div class="row">
        <div class="row text-center">

            <!-- ==========================
              TARJETA 1: LISTAR USUARIOS
            =========================== -->
            <div class="col-sm-4 mb-3 mb-sm-0">
                <div class="card" style="background: linear-gradient(180deg,  #0f172a,#10315c,#0f172a);">
                    <div class="row g-0">
                        <div class="col-md-8">
                            <div class="card-body text-white">
                                <h5 class="card-title">Listar Usuarios</h5>
                                
                                <!-- CONTADOR DE USUARIOS - SOLO EL NÚMERO -->
                                <div class="counter-simple mb-2">
                                    {{ user_count }}
                                </div>
                                
                                {# Botón que lleva a la página de listar usuarios #}
                                <a href="{{ url_for('listar_usuarios')}}" class="btn btn-outline-success">Ver Detalles</a>
                            </div>
                        </div>
                        <div class="col-md-4 align-content-center">
                            {# Imagen representativa del perfil de usuario #}
                            <img src="{{ url_for('static', filename='img/user.png') }}" class="img-fluid rounded-start" alt="Agregar Usuario ...">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==========================
              TARJETA 2: AGREGAR CURSOS
            =========================== -->
            <div class="col-sm-4 mb-3 mb-sm-0">
                <div class="card" style="background: linear-gradient(180deg, #0f172a,#10315c,#0f172a);">
                    <div class="row g-0">
                        <div class="col-md-8">
                            <div class="card-body text-white">
                                <h5 class="card-title">Agregar nuevos cursos</h5>
                                
                                <!-- CONTADOR DE CURSOS - SOLO EL NÚMERO -->
                                <div class="counter-simple mb-2">
                                    {{ course_count }}
                                </div>
                                
                                {# Botón que puede redirigir a agregar productos #}
                                <a href="{{ url_for('agregar_producto') }}" class="btn btn-outline-success">Ver Detalles</a>
                            </div>
                        </div>
                        <div class="col-md-4 align-content-center">
                            <a href="{{ url_for('agregar_producto') }}">
                                <img src="{{ url_for('static', filename='img/agregarp.png') }}" class="img-fluid rounded-start" alt="Agregar Producto">
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==========================
              TARJETA 3: VER CURSOS DISPONIBLES
            =========================== -->
            <div class="col-sm-4 mb-3 mb-sm-0">
                <div class="card" style="background: linear-gradient(180deg,  #0f172a,#10315c,#0f172a);">
                    <div class="row g-0">
                        <div class="col-md-8">
                            <div class="card-body text-white">
                                <h5 class="card-title">Ver cursos disponibles</h5>
                                
                                <!-- CONTADOR DE CURSOS - SOLO EL NÚMERO -->
                                <div class="counter-simple mb-2">
                                    {{ course_count }}
                                </div>
                                
                                {# Botón que redirige a la vista de productos #}
                                <a href="{{ url_for('listar_productos_agregados') }}" class="btn btn-outline-success">Ver Detalles</a>
                            </div>
                        </div>
                        <div class="col-md-4 align-content-center">
                            <img src="{{ url_for('static', filename='img/listarp.png') }}" class="img-fluid rounded-start" alt="Visualizar Productos">
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<style>
/* ==========================
  ESTILOS DEL CONTADOR SIMPLIFICADO
=========================== */
.counter-simple {
    font-size: 3rem;
    font-weight: bold;
    color: #4ade80;
    text-shadow: 0 0 15px rgba(74, 222, 128, 0.7);
    margin: 10px 0;
    line-height: 1;
    text-align: center;
}

/* ==========================
  ESTILOS RESPONSIVOS
=========================== */
@media (max-width: 768px) {
    .counter-simple {
        font-size: 2.5rem;
    }
}
</style>

{% endblock %}